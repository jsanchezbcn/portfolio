# Data Model: Trade Proposer Agent

## Entity: `ProposedTrade`

Represents a candidate hedging trade generated by the Proposer Agent.

| Field              | Type     | Description                                                                                      |
| ------------------ | -------- | ------------------------------------------------------------------------------------------------ |
| `id`               | Integer  | Primary key.                                                                                     |
| `account_id`       | String   | IBKR account ID (e.g., U1234567).                                                                |
| `strategy_name`    | String   | Descriptive name (e.g., "SPX Bear Put Spread 45 DTE").                                           |
| `legs_json`        | JSON     | List of dictionaries: `{conId, symbol, action, quantity}`.                                       |
| `net_premium`      | Float    | Estimated net credit (+) or debit (-) for the trade.                                             |
| `margin_impact`    | Float    | Estimated Initial Margin increase.                                                               |
| `efficiency_score` | Float    | Calculated ratio: (Risk Coverage / Capital Cost).                                                |
| `delta_reduction`  | Float    | Projected change in Beta-weighted SPX Delta.                                                     |
| `vega_reduction`   | Float    | Projected change in Portfolio Vega.                                                              |
| `status`           | Enum     | One of: `Pending`, `Approved`, `Rejected`, `Superseded`.                                         |
| `justification`    | String   | Narrative explaining why this hedge was chosen (e.g., "Corrects Vega breach in Neutral regime"). |
| `created_at`       | DateTime | UTC timestamp of generation.                                                                     |

## Relationships

- **One-to-Many**: One `GreekSnapshot` (from Bridge) may trigger multiple `ProposedTrade` candidates in a single batch.
- **State Transition**: All `Pending` trades for an account MUST be transitioned to `Superseded` when a new batch is created (Requirement FR-014).

## Validation Rules

1. `legs_json` must contain at least one leg.
2. `margin_impact` must be positive if the trade increases requirement.
3. `status` defaults to `Pending`.
4. `efficiency_score` must be > 0 to be persisted.
